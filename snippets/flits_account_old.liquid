{{ 'customer.css' | asset_url | stylesheet_tag }}
<div class="customer-main">
    <div class="customer account">
        <div class="customer-left">
            <div class="customer-menu">
                <div class="username-boxs"><svg viewBox="0 0 21.9 19.5">
                        <path d="M11,10.1c2.8,0,5-2.3,5-5.1c0-2.8-2.3-5-5.1-5c-2.8,0-5,2.3-5,5.1c0,0,0,0,0,0C6,7.8,8.2,10.1,11,10.1z" />
                        <path d="M15.7,10.1L15.2,10l-0.3,0.3c-2.2,2.1-5.7,2.1-7.9,0L6.7,10l-0.4,0.1C2.8,10.3,0,13.3,0,16.8v2.7h21.9v-2.7 C21.9,13.3,19.2,10.3,15.7,10.1L15.7,10.1z" />
                    </svg> Hello {{ customer.first_name }}</div>
                <ul class="menu">{% for account in linklists.account-menu.links %}<li><a href="{{ account.url }}" class="{% if account.active %}active{% endif %} {{ account.title }} {% if account.title == "Wishlist" %} my-wishlist{% endif %}">{{ account.title }}</a></li>{% endfor %}</ul>
            </div>
        </div>
        <div class="customer-right">
            <div class="customer-group">
                <h2 class="mobile-hide">My Profile</h2>
                <div class="mobile-show">
                    <div class="username-boxs"><svg viewBox="0 0 21.9 19.5">
                            <path d="M11,10.1c2.8,0,5-2.3,5-5.1c0-2.8-2.3-5-5.1-5c-2.8,0-5,2.3-5,5.1c0,0,0,0,0,0C6,7.8,8.2,10.1,11,10.1z" />
                            <path d="M15.7,10.1L15.2,10l-0.3,0.3c-2.2,2.1-5.7,2.1-7.9,0L6.7,10l-0.4,0.1C2.8,10.3,0,13.3,0,16.8v2.7h21.9v-2.7 C21.9,13.3,19.2,10.3,15.7,10.1L15.7,10.1z" />
                        </svg> Hello {{ customer.first_name }}</div><a href="/account/logout" class="logout-text">Logout</a>
                </div>
                <ul class="profile-main">
                    <li><span>Name</span>
                        <p>{{ customer.first_name }} {{ customer.last_name }}</p>
                    </li>
                    <li><span>Email</span>
                        <p>{{ customer.email }}</p>
                    </li>
                    <li><span>Phone number</span>
                        <p>{{ customer.phone }}</p>
                    </li>
                </ul>
            </div>
            <div class="customer-group">
                <h2>{{ 'customer.orders.title' | t }}</h2>{%- if customer.orders.size > 0 -%}<table role="table" class="order-history">
                    <caption class="visually-hidden">{{ 'customer.orders.title' | t }}</caption>
                    <thead role="rowgroup">
                        <tr role="row">
                            <th id="ColumnOrder" scope="col" role="columnheader">{{ 'customer.orders.order_number' | t }}</th>
                            <th id="ColumnDate" scope="col" role="columnheader">{{ 'customer.orders.date' | t }}</th>
                            <th id="ColumnPayment" scope="col" role="columnheader">{{ 'customer.orders.payment_status' | t }}</th>
                            <th id="ColumnTotal" scope="col" role="columnheader">{{ 'customer.orders.total' | t }}</th>
                            <th id="ColumnFulfillment" scope="col" role="columnheader">{{ 'ORDER STATUS' | }}</th>
                            <th>Actions</th>
                            <!---->
                        </tr>
                    </thead>
                    <tbody role="rowgroup">
                        {%- for order in customer.orders limit: 3 -%}<tr role="row">
                            <td id="RowOrder"role="cell"headers="ColumnOrder"data-label="{{ 'customer.orders.order_number' | t }}"><a href="{{ order.customer_url }}" aria-label="{{ 'customer.orders.order_number_link' | t: number: order.name }}">{{ order.name }}</a></td>
                                <td headers="RowOrder ColumnDate" role="cell" data-label="{{ 'customer.orders.date' | t }}">{{ order.created_at | date: "%d %b %y" }}</td>
                                <td headers="RowOrder ColumnPayment" role="cell" data-label="{{ 'customer.orders.payment_status' | t }}">{% if order.financial_status_label == "Pending" %}COD{% else %}Pre - Paid{% endif %}</td>
                                <td headers="RowOrder ColumnTotal" role="cell" data-label="{{ 'customer.orders.total' | t }}">{{ order.total_price | money_with_currency }}</td>
                                <td headers="RowOrder ColumnFulfillment" role="cell" data-label="{{ 'ORDER STATUS' |}}"><a href="{{ order.customer_url }}?return=trackorder" class="Button">Track Order</a></td>
                                <td>
                                    <div class="actions-link">
                                        <span data-order_name={{order.id}} data-label="Return/Exchange" class="return__exchange">
                                            <button class="js-return-exchange {% if order.fulfillment_status == 'unfulfilled' %} disabled{% endif %}" data-order="{{ order.name }}" data-customer="{{ customer.email }}">Return</button>
                                        </span>
                                        <span class="separator">|</span>
                                        {% assign order_status = order.fulfillment_status %} 
                                        {% assign cancel_status = order.cancelled_at %}
                                        {% if order_status == 'fulfilled' or cancel_status != null%}
                                            <span class="offtext">Edit or Cancel</span> 
                                        {% else %} 
                                        {% if order.tags contains 'personalise-product' %}
                                            <span><a onclick="return alert('Cannot cancel a order containing personalisation product.')">Edit or Cancel</a></span>
                                          {% elsif order.tags contains 'gift_card' %}
                                            <span><a onclick="return alert('Cannot cancel a order containing Gift Card')">Edit or Cancel</a></span>
                                          {% elsif order.tags contains 'GST_ORDER' %}
                                            <span><a onclick="return alert('Cannot cancel a GST involved order')">Edit or Cancel</a></span>
                                          {% else %}
                                            <span><a target="_blank" href="https://shopify-order-edit.herokuapp.com/order-editor/my-borosil.myshopify.com/{{order.id}}">Edit or Cancel</a></span>
                                          {% endif %}
                                        {% endif %}
                                        <span class="separator">|</span>
                                        <span><a href="{{ order.customer_url }}">View</a></span>                                                                        
                                    </div>
                                </td>
                            </tr>
                        {%- endfor -%}
                    </tbody>
                </table>
                <div class="button-main"><a href="/pages/orders" class="btn-view">View All</a></div>{%- else -%}<p>{{ 'customer.orders.none' | t }}</p>{%- endif -%}
            </div>
        </div>
    </div>
</div>
<script>
    const url = sessionStorage.getItem("url");
    if (url.includes("registration")) {
        sessionStorage.removeItem('url');
        window.location.href = url;
    }
</script>
{% render 'returnprime_script' %}